<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>yescallop&#39;s blog</title>
  
  
  <link href="https://yescallop.cn/atom.xml" rel="self"/>
  
  <link href="https://yescallop.cn/"/>
  <updated>2021-11-04T08:29:05.143Z</updated>
  <id>https://yescallop.cn/</id>
  
  <author>
    <name>Scallop Ye</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>两岸差异用词爬虫</title>
    <link href="https://yescallop.cn/posts/2017/clcrawler/"/>
    <id>https://yescallop.cn/posts/2017/clcrawler/</id>
    <published>2017-09-10T14:14:14.000Z</published>
    <updated>2021-11-04T08:29:05.143Z</updated>
    
    <content type="html"><![CDATA[<p>写在开头 - <strong>Java 大法好</strong></p><p>昨天我在把一个电影字幕从繁体转成简体时，发现转完后有一些台湾地区的用词（繁体字幕大部分都是台湾的），所以突发灵感想写个翻译程序。</p><p>首先得有个词库，<a href="http://chinese-linguipedia.org/clk/diff">Chinese Linguipedia</a> 这个网站，里边有个两岸差异用词，看上去挺全的，就选它了。</p><span id="more"></span><p>词语有三级分类，每页最多十行，链接如此：<br><code>http://chinese-linguipedia.org/clk/diff?class=二级分类编号&amp;classNa=三级分类名称&amp;page=页面</code></p><p>编号范围是 1~34，其中 1~5 是五个一级分类的编号。因为爬下来的数据要细分，所以就忽略大分类，直接从分类 6~34 每一页遍历过去获取。<br>同时，只有 6, 7, 8 三个二级分类下有三级分类，这些分类我手打进了一个 <a href="https://github.com/yescallop/ChineseLinguipediaCrawler/blob/master/src/structure.json">json</a> 里。</p><p>然后是网页处理部分</p><p>每一页都有几段这样的 html：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">td</span> <span class="attr">align</span>=<span class="string">&#x27;center&#x27;</span>;&gt;</span>同實異名<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">&quot;head3&quot;</span> <span class="attr">style</span>=<span class="string">&quot;font-family:&#x27;微軟正黑體&#x27;;font-size:1.1em;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://chinese-linguipedia.org/clk/search/刀具/0/0?srchType=1&quot;</span>&gt;</span>刀具<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">&quot;head3&quot;</span> <span class="attr">style</span>=<span class="string">&quot;font-family:&#x27;微軟正黑體&#x27;;font-size:1.1em;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://chinese-linguipedia.org/clk/search/刀具/0/0?srchType=1&quot;</span>&gt;</span>刀具<span class="tag">&lt;/<span class="name">a</span>&gt;</span>/<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://chinese-linguipedia.org/clk/search/刃具/0/0?srchType=1&quot;</span>&gt;</span>刃具<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br></pre></td></tr></table></figure><p>首先通过正则表达式 <code>&lt;td align=&#39;center&#39;;&gt;(.*?)&lt;/td&gt;\r\n(.*?)\r\n(.*)</code><br>取出 $1 “同異類別”、$2 “臺灣語詞” 的元素、$3 “大陸語詞” 的元素<br>然后用另一个正则表达式 <code>1\&quot;&gt;([\s\S]*?)&lt;/a</code> 匹配 $2 和 $3，得到每个“臺灣語詞”和“大陸語詞”，之后以<code>/</code>为分隔符合并<br>向 <em>output.csv</em> 文件写入一行：<code>一级分类,二级分类,三级分类,同異類別,臺灣語詞,大陸語詞</code></p><p>有人可能注意到上面用了一个 <code>[\s\S]</code>，这里是因为网站的数据有点问题，有一条记录的词里边有个换行，导致获取不到这条记录。</p><p>合并字符串集合或数组，用到了一个 Java 8 String 类的新方法 String.join，第一个参数是分隔符字符串，第二个参数是一个集合或者数组</p><p>至于翻译程序，晚点再来弄，目前计划是检测到一个台湾用词，就显示出相对应的所有大陆用词，可以自定义更改的词语。</p><p>需要考虑到一个词语重叠问题，和类似于“簡訊地址”这样的词语的翻译问题，应该需要翻译为“联系方式”。</p><p>还有一些这个词库里没有涉及到的词语，例如“聯絡”和“联系”，网站上面显示的是大陆“今不用”此词语，可以通过增加的方法来完善。</p><p><strong>同时这个网站支持通配符查询功能，应该可以将整部字典都爬下来，只是一个时间问题。</strong></p><p>若有哪位大神比较熟悉于这方面的问题，我们可以互相讨论一下，来共同完成这个项目。</p><p>本项目的 GitHub：<br><a href="https://github.com/yescallop/ChineseLinguipediaCrawler">https://github.com/yescallop/ChineseLinguipediaCrawler</a></p><p>PS: 微软系列产品不能正确识别无 BOM 头的 UTF-8 编码文件，需要在写入数据之前在文件头写入 BOM 头 <code>0xEFBBBF</code></p><p>PPS: 这个网站早已大改，我对 Java 的记忆也已变淡，谨以此篇留作纪念。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;写在开头 - &lt;strong&gt;Java 大法好&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;昨天我在把一个电影字幕从繁体转成简体时，发现转完后有一些台湾地区的用词（繁体字幕大部分都是台湾的），所以突发灵感想写个翻译程序。&lt;/p&gt;
&lt;p&gt;首先得有个词库，&lt;a href=&quot;http://chinese-linguipedia.org/clk/diff&quot;&gt;Chinese Linguipedia&lt;/a&gt; 这个网站，里边有个两岸差异用词，看上去挺全的，就选它了。&lt;/p&gt;</summary>
    
    
    
    <category term="数据" scheme="https://yescallop.cn/categories/%E6%95%B0%E6%8D%AE/"/>
    
    
    <category term="Java" scheme="https://yescallop.cn/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>在树莓派上搭建邮件服务器 Postfix + Dovecot + SASL</title>
    <link href="https://yescallop.cn/posts/2016/mailserver/"/>
    <id>https://yescallop.cn/posts/2016/mailserver/</id>
    <published>2016-07-02T20:54:14.000Z</published>
    <updated>2021-11-04T08:29:05.143Z</updated>
    
    <content type="html"><![CDATA[<p>最近入手了一台树莓派 3B，要把 ECS 上的各种服务器全部迁移到上面，配置邮件服务器的方法有些麻烦，所以在此写一篇教程分享给大家供借鉴。</p><span id="more"></span><blockquote><p>更新 2017-04-29: 无法发送邮件，很久没有解决<br>更新 2017-08-23: 发件问题已修复</p></blockquote><h2 id="准备环境"><a href="#准备环境" class="headerlink" title="准备环境"></a>准备环境</h2><p><strong>Raspberry Pi 3 Model B</strong>，运行 <strong>Raspbian</strong> 最新版本</p><h2 id="开始搭建"><a href="#开始搭建" class="headerlink" title="开始搭建"></a>开始搭建</h2><p>首先通过 apt-get 获取 Postfix，Dovecot 和 SASL</p><p>我个人认为 IMAP 比 POP3 好，所以在此没有配置 POP3，如有需要请加上 dovecot-pop3d</p><p><code>sudo apt-get install postfix dovecot-imapd sasl2-bin</code></p><h3 id="配置-Postfix-和-SASL"><a href="#配置-Postfix-和-SASL" class="headerlink" title="配置 Postfix 和 SASL"></a>配置 Postfix 和 SASL</h3><p>下面部分内容借鉴了 Debian 官方 Wiki 的文章 <a href="https://wiki.debian.org/PostfixAndSASL">PostfixAndSASL</a></p><ol><li><p>创建一个文件 /etc/postfix/sasl/smtpd.conf，内容如下</p><pre><code> pwcheck_method: saslauthd mech_list: PLAIN LOGIN</code></pre></li><li><p>复制 /etc/default/saslauthd 到 /etc/default/saslauthd-postfix，修改内容如下</p><pre><code> START=yes DESC=&quot;SASL Auth. Daemon for Postfix&quot; NAME=&quot;saslauthd-postf&quot; # 最长为 15 字符 OPTIONS=&quot;-c -m /var/spool/postfix/var/run/saslauthd&quot;</code></pre></li><li><p>创建 Postfix 改变根目录所需的子目录，命令：</p><p> <code>sudo dpkg-statoverride --add root sasl 710 /var/spool/postfix/var/run/saslauthd</code></p></li><li><p>将 postfix 用户加入组 sasl</p><p> <code>sudo adduser postfix sasl</code></p></li><li><p>重启 saslauthd 服务</p><p> <code>sudo service saslauthd restart</code></p></li><li><p>编辑 Postfix 配置文件 /etc/postfix/main.cf，以我的域名 yescallop.cn 为例，修改内容如下</p><pre><code> myhostname = yescallop.cn myorigin = $myhostname mydestination = $myhostname, localhost smtpd_sasl_local_domain = $myhostname smtpd_sasl_auth_enable = yes broken_sasl_auth_clients = yes smtpd_sasl_security_options = noanonymous smtpd_recipient_restrictions = permit_sasl_authenticated, reject_unauth_destination</code></pre></li><li><p>重启 Postfix （重载配置是不够的）</p><p> <code>sudo service postfix restart</code></p></li></ol><p>然后就可以使用 telnet 连接 25 端口测试了</p><h3 id="配置-Dovecot"><a href="#配置-Dovecot" class="headerlink" title="配置 Dovecot"></a>配置 Dovecot</h3><ol><li><p>编辑 Dovecot 配置文件 /etc/dovecot/dovecot.conf，修改内容如下：</p><pre><code> listen = *</code></pre></li><li><p>编辑认证配置文件 /etc/dovecot/conf.d/10-auth.conf，修改内容如下：</p><pre><code> disable_plaintext_auth = no auth_mechanisms = plain login</code></pre></li><li><p>编辑 IMAP 配置文件 /etc/dovecot/conf.d/20-imap.conf，修改内容如下：</p><pre><code> mail_max_userip_connections = 100 # 此处可自定义，不要太小，容易导致连接被拒绝</code></pre></li><li><p>重启 Dovecot</p><p> <code>sudo service dovecot restart</code></p></li></ol><p>可以使用 telnet 连接 143 端口测试</p><p>最后可以添加 Postfix，Dovecot 和 SASL 到启动组</p><pre><code>sudo update-rc.d postfix defaultssudo update-rc.d dovecot defaultssudo update-rc.d saslauthd defaults</code></pre><p><strong>All Done!</strong></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;最近入手了一台树莓派 3B，要把 ECS 上的各种服务器全部迁移到上面，配置邮件服务器的方法有些麻烦，所以在此写一篇教程分享给大家供借鉴。&lt;/p&gt;</summary>
    
    
    
    <category term="笔记" scheme="https://yescallop.cn/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Linux" scheme="https://yescallop.cn/tags/Linux/"/>
    
  </entry>
  
</feed>
